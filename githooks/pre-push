#!/bin/sh
set -eu

REPO_ROOT="$(git rev-parse --show-toplevel)"
cd "$REPO_ROOT"

echo "==> Running all pre-push checks in parallel..."

# Run all tasks in a single Gradle invocation with parallel execution
./gradlew --parallel \
    ktlintCheck \
    check \
    detekt \
    cleanJvmTest \
    jacocoJvmTestCoverageVerification \
    cleanTestDevDebugUnitTest \
    testDevDebugUnitTest \
    cleanIosSimulatorArm64Test \
    iosSimulatorArm64Test \
    assembleRelease \
    linkDebugFrameworkIosArm64 \
    jvmJar

echo "==> All pre-push checks completed successfully"
